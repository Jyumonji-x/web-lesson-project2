# webProject2
---
许同樵 19302010015
---
## 1 Github地址

Github地址：https://github.com/xtq2000/webProject2

---

## 2 项目完成情况

### 2.1 总体情况

1、页面重新全部使用了Bootstrap框架（除了登录和注册界面延用了原有风格外），因此project1中的css样式有很多已经无需使用。

2、Project支持多种语言，编写时使用Google Chrome进行过了测试，且可以在PC端和移动端使用。（因为Bootstrap自带的响应式布局）

3、Project基本思路：

在Pj2中基本做到了前后端分离（除了导航栏内容、注册登录内容尝试了一下在页面中嵌入Php代码的方法），所有功能的实现方式都为：

（1）在前端引入<div>元素，给定唯一的id

（2）js捕捉到事件后，使用ajax调用后端的php脚本（使用ajax从js对php传值）

（3）php脚本通过指令在Mysql中查找所需的数据（或改变数据），并返回给js（通过echo返回）（如果需要的话）

（4）js通过ajax接收数据并通过操作DOM的方式改变页面内容

#### 2.1.1 注册登录逻辑

注册登录逻辑基本全部使用了php的方式，在前端使用了内嵌php代码的方式。

基本逻辑：登录页面提交表单后查找mysql中是否有对应的用户。注册页面经过检查后到mysql添加数据。导航栏判断是否已经登录并显示不同的效果。

主要实现代码：

> $_SESSION\["sessionUid"]

可以将SESSION中的内容存储到服务器上，然后通过客户端传来的sessionID识别客户端的信息，并提取信息。

#### 2.1.2 各类查询搜索逻辑

主要使用了mysql指令：

> SELECT ... FROM ... WHERE ... (LIKE %搜索内容%)

#### 2.1.3 分页逻辑

php会获取所有的数据，由前端筛选其中需要显示的部分。

#### 2.1.4 上传、修改逻辑

修改逻辑主要使用了mysql指令：

>UPDATE ... SET ... WHERE ...

上传逻辑主要使用了mysql指令：

>INSERT INTO (...,...,...) VALUES (...,...,...)

### 2.2 具体情况

#### 2.2.1 主页

##### 导航栏

导航栏使用了内嵌php代码的方式实现。

判断SESSION的情况后显示不同的元素即可。

##### 图片展示区域

通过基本的js》php》mysql》php》js方式进行读取

随机刷新使用了另一个js脚本，实现方式类似

#### 2.2.2 浏览页

##### 筛选逻辑

通过js》php》mysql》php》js方式查询

##### 图片逻辑

通过操作DOM进行获取即可

全部延用了PJ1中使用css的自由版式裁剪的方式。

热门的定义方式：like最多的标签

#### 2.2.3 搜索页

逻辑同浏览页面

#### 2.2.4 上传页面

分为两个页面，分别为上传页面与修改页面。

修改页面中图片不能再重新上传。修改后重新提交给mysql的数据库即可。

上传页面用php接收表单，上传的图片名称会被改成uid名称+后缀的形式，可以防止重名的情况出现。

#### 2.2.5 我的照片

如果找不到图片，则会显示 You don't have any photos!

修改按钮会跳转到修改页面

#### 2.2.6 我的收藏

如果没有图片，则会显示 You don't have favorite photos!

Mysql指令使用了：

> SELECT ... FROM ... WHERE ... IN {...,...,...,...}

可以一次获取多个图片的信息

#### 2.2.7 登陆页面

如果能在数据库中找到匹配的用户，则会使用

>$_SESSION\["sessionUid"]=$uid;

给SESSION赋值，在其他页面就也可以保存登录的状态了。

#### 2.2.8 注册页面

信息是否填入，两次密码是否一致在前端js判断，合法性和安全性在后端php判断

合法用户名：大小写字母，数字，下划线，6-80位均可
> /^\[A-Za-z0-9_]{6,80}$/u

合法email：传统合法Email方式

>/^\[a-zA-Z0-9_-]+@\[a-zA-Z0-9_-]+(\.\[a-zA-Z0-9_-]+)+$/u

合法密码：大小写字母，数字，下划线，6-18位，安全密码需同时包含数字和字母

>/^\[A-Za-z0-9_]{6,18}$/u

>/^.*\[0-9]+.*$/u

>/^.*\[A-z]+.*$/u

#### 2.2.9 详细图片页面

Like如果在未登录时会变为不可用

like通过查找是否有用户和图片对应的like数据来改变其显示情况

通过url进行传值，以确认是哪张照片。

## 3 Bonus完成情况

### 3.1 Hash加盐

思路就是在register页面使用哈希加盐后的字符串进行上传，在登录页面先用mysql读取数据库中的密码，再与输入的字符比对

具体代码：

>加盐部分：password_hash($pass, PASSWORD_DEFAULT);

>比对部分：password_verify ($pass,$correctPass);

### 3.2 发布网站！

使用了阿里云服务器，宝塔面板进行发布。

还没有发布域名，域名正在备案，但是已经可以通过IP地址访问了。

网站地址：http://121.89.211.169/

除了有点慢以外，暂时还没有找到别的问题。

## 4 对PJ和本课程的建议

---

暂无